{% extends "base.html" %}
{% block content %}
<h1>Панель управления</h1>

<section class="grid">
  <div class="card">
    <h3>Отслеживаемые ссылки</h3>
    <form action="{{ url_for('add_track_route') }}" method="post" class="smallform">
      <input name="url" placeholder="URL раздела или темы" required>
      <input name="peer_id" placeholder="peer_id (VK) — необязательно">
      <button>Добавить</button>
    </form>
    <form action="{{ url_for('remove_track_route') }}" method="post" class="smallform">
      <input name="url" placeholder="URL для удаления">
      <input name="peer_id" placeholder="peer_id">
      <button>Удалить</button>
    </form>

    <div class="tracks">
      {% if tracks %}
        <ul>
        {% for t in tracks %}
          <li>{{ t }}</li>
        {% endfor %}
        </ul>
      {% else %}
        <div class="muted">Отслеживаний не найдено</div>
      {% endif %}
    </div>
  </div>

  <div class="card">
    <h3>Cookies (маскированно)</h3>
    <pre>{{ cookies }}</pre>
    <h3>Последние действия</h3>
    <ul class="list-compact">
      {% for a in actions %}
        <li>{{ a['ts_iso'] }} — {{ a['actor'] }} — {{ a['action'] }} — {{ a['details'] }}</li>
      {% endfor %}
    </ul>
  </div>

  <div class="card" id="live">
    <h3>Live логи</h3>
    <div id="logsbox" class="logsbox"></div>
    <button id="clearLocal">Очистить окно</button>
  </div>
</section>

{% endblock %}
